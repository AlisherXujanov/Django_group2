{% extends 'base.html' %}

{% block content %}
  <h1>{{ title }}</h1>

  <hr />

  <div class="container">
    <a href="{% url 'create_todo' %}" class="btn btn-primary btn-sm float-end">Create todo</a>

    <hr />
    <br />

    {% for item in todos %}
      <div class="card p-3 mb-2 bg-secondary text-light">
        <h5 class="card-title">{{ item.title|title }}</h5>
        <p class="card-text">{{ item.description }}</p>

        <div class="row">
          <a href="{% url 'todo_details' item.id %}" class="col btn btn-info">View</a>
          <a href="{% url 'update_todo' item.id %}" class="col btn btn-warning">Update</a>
          <a href="#" class="col btn btn-danger" onclick="handleDelete({{ item.id }})">Delete</a>
        </div>
      </div>
    {% endfor %}
  </div>
{% endblock %}

{% block script %}
  <script>
    function handleDelete(todoID) {
      Swal.fire({
        title: 'Are you sure?',
        text: "You won't be able to revert this!",
        icon: 'warning',
        showCancelButton: true,
        confirmButtonColor: '#3085d6',
        cancelButtonColor: '#dd333350',
        confirmButtonText: 'Yes, delete it!'
      }).then((result) => {
        if (result.isConfirmed) {
          Swal.fire({
            title: 'Deleted!',
            text: 'Your file has been deleted.',
            icon: 'success'
          })
          let URL = "{% url 'delete_todo_item' 9999999999 %}"
          setTimeout(() => {
            location.href = URL.replace('9999999999', todoID)
          }, 1000)
        }
      })
    }
  </script>
{% endblock %}
